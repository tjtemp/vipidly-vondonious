/**
 * Created by joo on 17. 2. 3.
 */

    (function(){
  var Surface=function(node){
    var heightFunction,colorFunction,timer,timer,transformPrecalc=[];
    var displayWidth=300, displayHeight=300, zoom=1;
    var trans;


    this.setZoom=function(zoomLevel){
      zoom=zoomLevel;
      if(timer) clearTimeout(timer);
      timer=setTimeout(renderSurface);
    };
    var getHeights=function(){
      var data=node.datum();
      var output=[];
      var xlength=data.length;
      var ylength=data[0].length;
      for(var x=0;x<xlength;x++){
        output.push(t=[]);
        for(var y=0;y<ylength;y++){
            var value=heightFunction(data[x][y],x,y);
            t.push(value);
        }
      }
      return output;
    };
    var transformPoint=function(point){
      var x=transformPrecalc[0]*point[0]+transformPrecalc[1]*point[1]+transformPrecalc[2]*point[2];
      var y=transformPrecalc[3]*point[0]+transformPrecalc[4]*point[1]+transformPrecalc[5]*point[2];
      var z=transformPrecalc[6]*point[0]+transformPrecalc[7]*point[1]+transformPrecalc[8]*point[2];
      return [x,y,z];
    };
    var getTransformedData=function(){
      var data=node.datum();
      if(!heightFunction) return [[]];
      var t, output=[];
      var heights=getHeights();
      var xlength=data.length;
      var ylength=data[0].length;
      for(var x=0;x<xlength;x++){
        output.push(t=[]);
        for(var y=0;y<ylength;y++){
          t.push(transformPoint([(x-xlength/2)/(xlength*1.41)*displayWidth*zoom, heights[x][y]*zoom, (y-ylength/2)/(ylength*1.41)*displayWidth*zoom]));
        }
      }
      return output;
    };
    var renderSurface=function(){
      var originalData=node.datum();
      var data=getTransformedData();
      var xlength=data.length;
      var ylength=data[0].length;
      var d0=[];
      var idx=0;
      for(var x=0;x<xlength-1;x++){
        for(var y=0;y<ylength-1;y++){
          var depth=data[x][y][2]+data[x+1][y][2]+data[x+1][y+1][2]+data[x][y+1][2];
          d0.push({
            path:
              'M'+(data[x][y][0]+displayWidth/2).toFixed(10)+','+(data[x][y][1]+displayHeight/2).toFixed(10)+
              'L'+(data[x+1][y][0]+displayWidth/2).toFixed(10)+','+(data[x+1][y][1]+displayHeight/2).toFixed(10)+
              'L'+(data[x+1][y+1][0]+displayWidth/2).toFixed(10)+','+(data[x+1][y+1][1]+displayHeight/2).toFixed(10)+
              'L'+(data[x][y+1][0]+displayWidth/2).toFixed(10)+','+(data[x][y+1][1]+displayHeight/2).toFixed(10)+'Z',
            depth: depth, data: originalData[x][y]
          });
        }
      }
      d0.sort(function(a, b){return b.depth-a.depth});
      var dr=node.selectAll('path').data(d0);
      dr.enter().append("path");
      if(trans){
        dr=dr.transition().delay(trans.delay()).duration(trans.duration());
      }
      dr.attr("d",function(d){return d.path;});
      if(colorFunction){
        dr.attr("fill",function(d){return colorFunction(d.data)});
      }
      trans=false;
    };
    this.renderSurface=renderSurface;
    this.setTurtable=function(yaw, pitch){
      var cosA=Math.cos(pitch);
      var sinA=Math.sin(pitch);
      var cosB=Math.cos(yaw);
      var sinB=Math.sin(yaw);
      transformPrecalc[0]=cosB;
      transformPrecalc[1]=0;
      transformPrecalc[2]=sinB;
      transformPrecalc[3]=sinA*sinB;
      transformPrecalc[4]=cosA;
      transformPrecalc[5]=-sinA*cosB;
      transformPrecalc[6]=-sinB*cosA;
      transformPrecalc[7]=sinA;
      transformPrecalc[8]=cosA*cosB;
      if(timer) clearTimeout(timer);
      timer=setTimeout(renderSurface);
      return this;
    };
    this.setTurtable(0.5,0.5);
    this.surfaceColor=function(callback){
      colorFunction=callback;
      if(timer) clearTimeout(timer);
      timer=setTimeout(renderSurface);
      return this;
    };
    this.surfaceHeight=function(callback){
      heightFunction=callback;
      if(timer) clearTimeout(timer);
      timer=setTimeout(renderSurface);
      return this;
    };
    this.transition=function(){
      var transition=d3.selection.prototype.transition.bind(node)();
      colourFunction=null;
      heightFunction=null;
      transition.surfaceHeight=this.surfaceHeight;
      transition.surfaceColor=this.surfaceColor;
      trans=transition;
      return transition;
    };
    this.setHeight=function(height){
      if(height) displayHeight=height;
    };
    this.setWidth=function(width){
      if(width) displayWidth=width;
    };
  };
  d3.selection.prototype.surface3D=function(width,height){
    if(!this.node().__surface__) this.node().__surface__=new Surface(this);
    var surface=this.node().__surface__;
    this.turntable=surface.setTurtable;
    this.surfaceColor=surface.surfaceColor;
    this.surfaceHeight=surface.surfaceHeight;
    this.zoom=surface.setZoom;
    surface.setHeight(height);
    surface.setWidth(width);
    this.transition=surface.transition.bind(surface);
    return this;
  };
})();


$(document).ready(function(){
  var yaw=0.5,pitch=0.5, width=700, height=400, drag=false;

  function dataFromFormular(func){
    var output=[];
    for(var x=-20;x<20;x++){
      var f0=[];
      output.push(f0);
      for(var y=-20;y<20;y++){
          f0.push(func(x,y));
      }
    }
    return output;
  }

  var surfaces=[
    {
      name: 'Dataset 1',
      data: [[-44.05124104, -49.55267006, -48.82555555, -42.36704525,
        -31.32994897, -17.27876079,  -1.92712343,  13.100533  ,
         26.45245473,  37.16219398,  44.68883155,  48.89471703,
         49.97791099,  48.37926464,  44.68293574,  39.52529667,
         33.52200674,  27.21773934,  21.0585839 ,  15.38398164,
         10.43331167,   6.3617409 ,   3.26034351,   1.17639653,
          0.1308314 ,   0.1308314 ,   1.17639653,   3.26034351,
          6.3617409 ,  10.43331167,  15.38398164,  21.0585839 ,
         27.21773934,  33.52200674,  39.52529667,  44.68293574,
         48.37926464,  49.97791099,  48.89471703,  44.68883155,
         37.16219398,  26.45245473,  13.100533  ,  -1.92712343,
        -17.27876079, -31.32994897, -42.36704525, -48.82555555,
        -49.55267006, -44.05124104],
       [-49.55267006, -48.65355867, -41.50974692, -29.41449899,
        -14.16323739,   2.25956202,  17.97162887,  31.42107575,
         41.52825206,  47.73654523,  49.98295952,  48.60971434,
         44.2426231 ,  37.66118052,  29.68052637,  21.0585839 ,
         12.43444466,   4.29784512,  -3.01485101,  -9.30515297,
        -14.48500294, -18.54423721, -21.51831106, -23.45995778,
        -24.41694066, -24.41694066, -23.45995778, -21.51831106,
        -18.54423721, -14.48500294,  -9.30515297,  -3.01485101,
          4.29784512,  12.43444466,  21.0585839 ,  29.68052637,
         37.66118052,  44.2426231 ,  48.60971434,  49.98295952,
         47.73654523,  41.52825206,  31.42107575,  17.97162887,
          2.25956202, -14.16323739, -29.41449899, -41.50974692,
        -48.65355867, -49.55267006],
       [-48.82555555, -41.50974692, -28.75928737, -12.57683887,
          4.77658056,  21.13453178,  34.70993361,  44.27783047,
         49.24556663,  49.62054713,  45.90063253,  38.91963015,
         29.68052637,  19.203632  ,   8.40800154,  -1.96524628,
        -11.38773928, -19.54313453, -26.30068998, -31.67378034,
        -35.77286234, -38.76008802, -40.81010561, -42.07919314,
        -42.6831154 , -42.6831154 , -42.07919314, -40.81010561,
        -38.76008802, -35.77286234, -31.67378034, -26.30068998,
        -19.54313453, -11.38773928,  -1.96524628,   8.40800154,
         19.203632  ,  29.68052637,  38.91963015,  45.90063253,
         49.62054713,  49.24556663,  44.27783047,  34.70993361,
         21.13453178,   4.77658056, -12.57683887, -28.75928737,
        -41.50974692, -48.82555555],
       [-42.36704525, -29.41449899, -12.57683887,   5.61500264,
         22.6846354 ,  36.56495468,  45.83707278,  49.83312362,
         48.60971434,  42.81971738,  33.52200674,  21.97115032,
          9.42347921,  -3.01485101, -14.48500294, -24.41694066,
        -32.52344566, -38.76008802, -43.26604004, -46.29910521,
        -48.17499183, -49.21686027, -49.71746546, -49.9134038 ,
        -49.96931035, -49.96931035, -49.9134038 , -49.71746546,
        -49.21686027, -48.17499183, -46.29910521, -43.26604004,
        -38.76008802, -32.52344566, -24.41694066, -14.48500294,
         -3.01485101,   9.42347921,  21.97115032,  33.52200674,
         42.81971738,  48.60971434,  49.83312362,  45.83707278,
         36.56495468,  22.6846354 ,   5.61500264, -12.57683887,
        -29.41449899, -42.36704525],
       [-31.32994897, -14.16323739,   4.77658056,  22.6846354 ,
         37.16219398,  46.53016369,  49.98295952,  47.58177837,
         40.11503905,  28.87224009,  15.38398164,   1.17639653,
        -12.42420023, -24.41694066, -34.1789875 , -41.45470915,
        -46.29910521, -48.99592583, -49.96931035, -49.70326036,
        -48.67753066, -47.3230047 , -45.99528057, -44.96246634,
        -44.40206757, -44.40206757, -44.96246634, -45.99528057,
        -47.3230047 , -48.67753066, -49.70326036, -49.96931035,
        -48.99592583, -46.29910521, -41.45470915, -34.1789875 ,
        -24.41694066, -12.42420023,   1.17639653,  15.38398164,
         28.87224009,  40.11503905,  47.58177837,  49.98295952,
         46.53016369,  37.16219398,  22.6846354 ,   4.77658056,
        -14.16323739, -31.32994897],
       [-17.27876079,   2.25956202,  21.13453178,  36.56495468,
         46.53016369,  49.99858565,  46.96192173,  38.29820164,
         25.51450425,  10.43331167,  -5.11489064, -19.54313453,
        -31.67378034, -40.81010561, -46.72343969, -49.57790278,
        -49.82006561, -48.0597388 , -44.96246634, -41.16643766,
        -37.22859075, -33.59819679, -30.61197197, -28.50282892,
        -27.41435247, -27.41435247, -28.50282892, -30.61197197,
        -33.59819679, -37.22859075, -41.16643766, -44.96246634,
        -48.0597388 , -49.82006561, -49.57790278, -46.72343969,
        -40.81010561, -31.67378034, -19.54313453,  -5.11489064,
         10.43331167,  25.51450425,  38.29820164,  46.96192173,
         49.99858565,  46.53016369,  36.56495468,  21.13453178,
          2.25956202, -17.27876079],
       [ -1.92712343,  17.97162887,  34.70993361,  45.83707278,
         49.98295952,  46.96192173,  37.66118052,  23.76483689,
          7.38728486,  -9.30515297, -24.41694066, -36.54545526,
        -44.88457096, -49.21686027, -49.82006561, -47.3230047 ,
        -42.54666743, -36.35991327, -29.56888668, -22.84813325,
        -16.71188321, -11.51748444,  -7.48984656,  -4.75548615,
         -3.37638528,  -3.37638528,  -4.75548615,  -7.48984656,
        -11.51748444, -16.71188321, -22.84813325, -29.56888668,
        -36.35991327, -42.54666743, -47.3230047 , -49.82006561,
        -49.21686027, -44.88457096, -36.54545526, -24.41694066,
         -9.30515297,   7.38728486,  23.76483689,  37.66118052,
         46.96192173,  49.98295952,  45.83707278,  34.70993361,
         17.97162887,  -1.92712343],
       [ 13.100533  ,  31.42107575,  44.27783047,  49.83312362,
         47.58177837,  38.29820164,  23.76483689,   6.3617409 ,
        -11.38773928, -27.22644278, -39.46233846, -47.12355534,
        -49.96931035, -48.38350015, -43.1939961 , -35.4650208 ,
        -26.30403387, -16.71188321,  -7.48984656,   0.79661449,
          7.80751286,  13.38665832,  17.5046284 ,  20.20004232,
         21.52903306,  21.52903306,  20.20004232,  17.5046284 ,
         13.38665832,   7.80751286,   0.79661449,  -7.48984656,
        -16.71188321, -26.30403387, -35.4650208 , -43.1939961 ,
        -48.38350015, -49.96931035, -47.12355534, -39.46233846,
        -27.22644278, -11.38773928,   6.3617409 ,  23.76483689,
         38.29820164,  47.58177837,  49.83312362,  44.27783047,
         31.42107575,  13.100533  ],
       [ 26.45245473,  41.52825206,  49.24556663,  48.60971434,
         40.11503905,  25.51450425,   7.38728486, -11.38773928,
        -28.14077278, -40.81010561, -48.17499183, -49.90768134,
        -46.46747149, -38.88582763, -28.50282892, -16.71188321,
         -4.75548615,   6.40482147,  16.14071378,  24.14323823,
         30.3632855 ,  34.92886962,  38.05867484,  39.98551824,
         40.89717524,  40.89717524,  39.98551824,  38.05867484,
         34.92886962,  30.3632855 ,  24.14323823,  16.14071378,
          6.40482147,  -4.75548615, -16.71188321, -28.50282892,
        -38.88582763, -46.46747149, -49.90768134, -48.17499183,
        -40.81010561, -28.14077278, -11.38773928,   7.38728486,
         25.51450425,  40.11503905,  48.60971434,  49.24556663,
         41.52825206,  26.45245473],
       [ 37.16219398,  47.73654523,  49.62054713,  42.81971738,
         28.87224009,  10.43331167,  -9.30515297, -27.22644278,
        -40.81010561, -48.47468376, -49.70326036, -44.96246634,
        -35.4650208 , -22.84813325,  -8.84317884,   5.00127125,
         17.5046284 ,  27.93583221,  36.00235024,  41.77262971,
         45.56343465,  47.8206604 ,  49.01405644,  49.55635532,
         49.74867586,  49.74867586,  49.55635532,  49.01405644,
         47.8206604 ,  45.56343465,  41.77262971,  36.00235024,
         27.93583221,  17.5046284 ,   5.00127125,  -8.84317884,
        -22.84813325, -35.4650208 , -44.96246634, -49.70326036,
        -48.47468376, -40.81010561, -27.22644278,  -9.30515297,
         10.43331167,  28.87224009,  42.81971738,  49.62054713,
         47.73654523,  37.16219398],
       [ 44.68883155,  49.98295952,  45.90063253,  33.52200674,
         15.38398164,  -5.11489064, -24.41694066, -39.46233846,
        -48.17499183, -49.70326036, -44.40206757, -33.59819679,
        -19.21860024,  -3.37638528,  11.99895686,  25.42588987,
         36.00235024,  43.40992382,  47.8206604 ,  49.74867586,
         49.88842203,  48.97182072,  47.66207509,  46.48768883,
         45.8096484 ,  45.8096484 ,  46.48768883,  47.66207509,
         48.97182072,  49.88842203,  49.74867586,  47.8206604 ,
         43.40992382,  36.00235024,  25.42588987,  11.99895686,
         -3.37638528, -19.21860024, -33.59819679, -44.40206757,
        -49.70326036, -48.17499183, -39.46233846, -24.41694066,
         -5.11489064,  15.38398164,  33.52200674,  45.90063253,
         49.98295952,  44.68883155],
       [ 48.89471703,  48.60971434,  38.91963015,  21.97115032,
          1.17639653, -19.54313453, -36.54545526, -47.12355534,
        -49.90768134, -44.96246634, -33.59819679, -17.97344647,
         -0.59931159,  16.14071378,  30.3632855 ,  40.89717524,
         47.32556664,  49.88726895,  49.28902915,  46.48768883,
         42.49237499,  38.21862758,  34.40511192,  31.58534101,
         30.09542706,  30.09542706,  31.58534101,  34.40511192,
         38.21862758,  42.49237499,  46.48768883,  49.28902915,
         49.88726895,  47.32556664,  40.89717524,  30.3632855 ,
         16.14071378,  -0.59931159, -17.97344647, -33.59819679,
        -44.96246634, -49.90768134, -47.12355534, -36.54545526,
        -19.54313453,   1.17639653,  21.97115032,  38.91963015,
         48.60971434,  48.89471703],
       [ 49.97791099,  44.2426231 ,  29.68052637,   9.42347921,
        -12.42420023, -31.67378034, -44.88457096, -49.96931035,
        -46.46747149, -35.4650208 , -19.21860024,  -0.59931159,
         17.5046284 ,  32.69779178,  43.40992382,  49.01405644,
         49.74682053,  46.48768883,  40.47349117,  33.02229327,
         25.32127949,  18.30496288,  12.62191209,   8.66726834,
          6.64802231,   6.64802231,   8.66726834,  12.62191209,
         18.30496288,  25.32127949,  33.02229327,  40.47349117,
         46.48768883,  49.74682053,  49.01405644,  43.40992382,
         32.69779178,  17.5046284 ,  -0.59931159, -19.21860024,
        -35.4650208 , -46.46747149, -49.96931035, -44.88457096,
        -31.67378034, -12.42420023,   9.42347921,  29.68052637,
         44.2426231 ,  49.97791099],
       [ 48.37926464,  37.66118052,  19.203632  ,  -3.01485101,
        -24.41694066, -40.81010561, -49.21686027, -48.38350015,
        -38.88582763, -22.84813325,  -3.37638528,  16.14071378,
         32.69779178,  44.16929479,  49.55635532,  48.97182072,
         43.41218073,  34.40511192,  23.6334479 ,  12.62191209,
          2.54010926,  -5.86406493, -12.22069342, -16.42524335,
        -18.50479761, -18.50479761, -16.42524335, -12.22069342,
         -5.86406493,   2.54010926,  12.62191209,  23.6334479 ,
         34.40511192,  43.41218073,  48.97182072,  49.55635532,
         44.16929479,  32.69779178,  16.14071378,  -3.37638528,
        -22.84813325, -38.88582763, -48.38350015, -49.21686027,
        -40.81010561, -24.41694066,  -3.01485101,  19.203632  ,
         37.66118052,  48.37926464],
       [ 44.68293574,  29.68052637,   8.40800154, -14.48500294,
        -34.1789875 , -46.72343969, -49.82006561, -43.1939961 ,
        -28.50282892,  -8.84317884,  11.99895686,  30.3632855 ,
         43.40992382,  49.55635532,  48.59515508,  41.51268165,
         30.09542706,  16.44707577,   2.54010926, -10.10434008,
        -20.56322029, -28.49062723, -33.97384411, -37.32946284,
        -38.90060036, -38.90060036, -37.32946284, -33.97384411,
        -28.49062723, -20.56322029, -10.10434008,   2.54010926,
         16.44707577,  30.09542706,  41.51268165,  48.59515508,
         49.55635532,  43.40992382,  30.3632855 ,  11.99895686,
         -8.84317884, -28.50282892, -43.1939961 , -49.82006561,
        -46.72343969, -34.1789875 , -14.48500294,   8.40800154,
         29.68052637,  44.68293574],
       [ 39.52529667,  21.0585839 ,  -1.96524628, -24.41694066,
        -41.45470915, -49.57790278, -47.3230047 , -35.4650208 ,
        -16.71188321,   5.00127125,  25.42588987,  40.89717524,
         49.01405644,  48.97182072,  41.51268165,  28.55383208,
         12.62191209,  -3.74796758, -18.50479761, -30.37107193,
        -38.90060036, -44.33911505, -47.3636218 , -48.78775742,
        -49.30414846, -49.30414846, -48.78775742, -47.3636218 ,
        -44.33911505, -38.90060036, -30.37107193, -18.50479761,
         -3.74796758,  12.62191209,  28.55383208,  41.51268165,
         48.97182072,  49.01405644,  40.89717524,  25.42588987,
          5.00127125, -16.71188321, -35.4650208 , -47.3230047 ,
        -49.57790278, -41.45470915, -24.41694066,  -1.96524628,
         21.0585839 ,  39.52529667],
       [ 33.52200674,  12.43444466, -11.38773928, -32.52344566,
        -46.29910521, -49.82006561, -42.54666743, -26.30403387,
         -4.75548615,  17.5046284 ,  36.00235024,  47.32556664,
         49.74682053,  43.41218073,  30.09542706,  12.62191209,
         -5.86406493, -22.59585866, -35.6853225 , -44.33911505,
        -48.78775742, -49.99984285, -49.29633006, -47.97938883,
        -47.05222652, -47.05222652, -47.97938883, -49.29633006,
        -49.99984285, -48.78775742, -44.33911505, -35.6853225 ,
        -22.59585866,  -5.86406493,  12.62191209,  30.09542706,
         43.41218073,  49.74682053,  47.32556664,  36.00235024,
         17.5046284 ,  -4.75548615, -26.30403387, -42.54666743,
        -49.82006561, -46.29910521, -32.52344566, -11.38773928,
         12.43444466,  33.52200674],
       [ 27.21773934,   4.29784512, -19.54313453, -38.76008802,
        -48.99592583, -48.0597388 , -36.35991327, -16.71188321,
          6.40482147,  27.93583221,  43.40992382,  49.88726895,
         46.48768883,  34.40511192,  16.44707577,  -3.74796758,
        -22.59585866, -37.32946284, -46.46786759, -49.91598595,
        -48.72592859, -44.63989072, -39.57750286, -35.21505282,
        -32.73533634, -32.73533634, -35.21505282, -39.57750286,
        -44.63989072, -48.72592859, -49.91598595, -46.46786759,
        -37.32946284, -22.59585866,  -3.74796758,  16.44707577,
         34.40511192,  46.48768883,  49.88726895,  43.40992382,
         27.93583221,   6.40482147, -16.71188321, -36.35991327,
        -48.0597388 , -48.99592583, -38.76008802, -19.54313453,
          4.29784512,  27.21773934],
       [ 21.0585839 ,  -3.01485101, -26.30068998, -43.26604004,
        -49.96931035, -44.96246634, -29.56888668,  -7.48984656,
         16.14071378,  36.00235024,  47.8206604 ,  49.28902915,
         40.47349117,  23.6334479 ,   2.54010926, -18.50479761,
        -35.6853225 , -46.46786759, -49.99984285, -47.05222652,
        -39.57750286, -30.0576376 , -20.86324707, -13.81607136,
        -10.04083694, -10.04083694, -13.81607136, -20.86324707,
        -30.0576376 , -39.57750286, -47.05222652, -49.99984285,
        -46.46786759, -35.6853225 , -18.50479761,   2.54010926,
         23.6334479 ,  40.47349117,  49.28902915,  47.8206604 ,
         36.00235024,  16.14071378,  -7.48984656, -29.56888668,
        -44.96246634, -49.96931035, -43.26604004, -26.30068998,
         -3.01485101,  21.0585839 ],
       [ 15.38398164,  -9.30515297, -31.67378034, -46.29910521,
        -49.70326036, -41.16643766, -22.84813325,   0.79661449,
         24.14323823,  41.77262971,  49.74867586,  46.48768883,
         33.02229327,  12.62191209, -10.10434008, -30.37107193,
        -44.33911505, -49.91598595, -47.05222652, -37.49579308,
        -24.11768466, -10.04083694,   2.14016857,  10.79132365,
         15.20233285,  15.20233285,  10.79132365,   2.14016857,
        -10.04083694, -24.11768466, -37.49579308, -47.05222652,
        -49.91598595, -44.33911505, -30.37107193, -10.10434008,
         12.62191209,  33.02229327,  46.48768883,  49.74867586,
         41.77262971,  24.14323823,   0.79661449, -22.84813325,
        -41.16643766, -49.70326036, -46.29910521, -31.67378034,
         -9.30515297,  15.38398164],
       [ 10.43331167, -14.48500294, -35.77286234, -48.17499183,
        -48.67753066, -37.22859075, -16.71188321,   7.80751286,
         30.3632855 ,  45.56343465,  49.88842203,  42.49237499,
         25.32127949,   2.54010926, -20.56322029, -38.90060036,
        -48.78775742, -48.72592859, -39.57750286, -24.11768466,
         -6.11297976,  10.79132365,  24.02439425,  32.53979606,
         36.5327181 ,  36.5327181 ,  32.53979606,  24.02439425,
         10.79132365,  -6.11297976, -24.11768466, -39.57750286,
        -48.72592859, -48.78775742, -38.90060036, -20.56322029,
          2.54010926,  25.32127949,  42.49237499,  49.88842203,
         45.56343465,  30.3632855 ,   7.80751286, -16.71188321,
        -37.22859075, -48.67753066, -48.17499183, -35.77286234,
        -14.48500294,  10.43331167],
       [  6.3617409 , -18.54423721, -38.76008802, -49.21686027,
        -47.3230047 , -33.59819679, -11.51748444,  13.38665832,
         34.92886962,  47.8206604 ,  48.97182072,  38.21862758,
         18.30496288,  -5.86406493, -28.49062723, -44.33911505,
        -49.99984285, -44.63989072, -30.0576376 , -10.04083694,
         10.79132365,  28.34765882,  40.24390575,  46.39010774,
         48.53552961,  48.53552961,  46.39010774,  40.24390575,
         28.34765882,  10.79132365, -10.04083694, -30.0576376 ,
        -44.63989072, -49.99984285, -44.33911505, -28.49062723,
         -5.86406493,  18.30496288,  38.21862758,  48.97182072,
         47.8206604 ,  34.92886962,  13.38665832, -11.51748444,
        -33.59819679, -47.3230047 , -49.21686027, -38.76008802,
        -18.54423721,   6.3617409 ],
       [  3.26034351, -21.51831106, -40.81010561, -49.71746546,
        -45.99528057, -30.61197197,  -7.48984656,  17.5046284 ,
         38.05867484,  49.01405644,  47.66207509,  34.40511192,
         12.62191209, -12.22069342, -33.97384411, -47.3636218 ,
        -49.29633006, -39.57750286, -20.86324707,   2.14016857,
         24.02439425,  40.24390575,  48.53552961,  49.85789854,
         48.27916691,  48.27916691,  49.85789854,  48.53552961,
         40.24390575,  24.02439425,   2.14016857, -20.86324707,
        -39.57750286, -49.29633006, -47.3636218 , -33.97384411,
        -12.22069342,  12.62191209,  34.40511192,  47.66207509,
         49.01405644,  38.05867484,  17.5046284 ,  -7.48984656,
        -30.61197197, -45.99528057, -49.71746546, -40.81010561,
        -21.51831106,   3.26034351],
       [  1.17639653, -23.45995778, -42.07919314, -49.9134038 ,
        -44.96246634, -28.50282892,  -4.75548615,  20.20004232,
         39.98551824,  49.55635532,  46.48768883,  31.58534101,
          8.66726834, -16.42524335, -37.32946284, -48.78775742,
        -47.97938883, -35.21505282, -13.81607136,  10.79132365,
         32.53979606,  46.39010774,  49.85789854,  44.28623795,
         36.24836084,  36.24836084,  44.28623795,  49.85789854,
         46.39010774,  32.53979606,  10.79132365, -13.81607136,
        -35.21505282, -47.97938883, -48.78775742, -37.32946284,
        -16.42524335,   8.66726834,  31.58534101,  46.48768883,
         49.55635532,  39.98551824,  20.20004232,  -4.75548615,
        -28.50282892, -44.96246634, -49.9134038 , -42.07919314,
        -23.45995778,   1.17639653],
       [  0.1308314 , -24.41694066, -42.6831154 , -49.96931035,
        -44.40206757, -27.41435247,  -3.37638528,  21.52903306,
         40.89717524,  49.74867586,  45.8096484 ,  30.09542706,
          6.64802231, -18.50479761, -38.90060036, -49.30414846,
        -47.05222652, -32.73533634, -10.04083694,  15.20233285,
         36.5327181 ,  48.53552961,  48.27916691,  36.24836084,
         17.73926045,  17.73926045,  36.24836084,  48.27916691,
         48.53552961,  36.5327181 ,  15.20233285, -10.04083694,
        -32.73533634, -47.05222652, -49.30414846, -38.90060036,
        -18.50479761,   6.64802231,  30.09542706,  45.8096484 ,
         49.74867586,  40.89717524,  21.52903306,  -3.37638528,
        -27.41435247, -44.40206757, -49.96931035, -42.6831154 ,
        -24.41694066,   0.1308314 ],
       [  0.1308314 , -24.41694066, -42.6831154 , -49.96931035,
        -44.40206757, -27.41435247,  -3.37638528,  21.52903306,
         40.89717524,  49.74867586,  45.8096484 ,  30.09542706,
          6.64802231, -18.50479761, -38.90060036, -49.30414846,
        -47.05222652, -32.73533634, -10.04083694,  15.20233285,
         36.5327181 ,  48.53552961,  48.27916691,  36.24836084,
         17.73926045,  17.73926045,  36.24836084,  48.27916691,
         48.53552961,  36.5327181 ,  15.20233285, -10.04083694,
        -32.73533634, -47.05222652, -49.30414846, -38.90060036,
        -18.50479761,   6.64802231,  30.09542706,  45.8096484 ,
         49.74867586,  40.89717524,  21.52903306,  -3.37638528,
        -27.41435247, -44.40206757, -49.96931035, -42.6831154 ,
        -24.41694066,   0.1308314 ],
       [  1.17639653, -23.45995778, -42.07919314, -49.9134038 ,
        -44.96246634, -28.50282892,  -4.75548615,  20.20004232,
         39.98551824,  49.55635532,  46.48768883,  31.58534101,
          8.66726834, -16.42524335, -37.32946284, -48.78775742,
        -47.97938883, -35.21505282, -13.81607136,  10.79132365,
         32.53979606,  46.39010774,  49.85789854,  44.28623795,
         36.24836084,  36.24836084,  44.28623795,  49.85789854,
         46.39010774,  32.53979606,  10.79132365, -13.81607136,
        -35.21505282, -47.97938883, -48.78775742, -37.32946284,
        -16.42524335,   8.66726834,  31.58534101,  46.48768883,
         49.55635532,  39.98551824,  20.20004232,  -4.75548615,
        -28.50282892, -44.96246634, -49.9134038 , -42.07919314,
        -23.45995778,   1.17639653],
       [  3.26034351, -21.51831106, -40.81010561, -49.71746546,
        -45.99528057, -30.61197197,  -7.48984656,  17.5046284 ,
         38.05867484,  49.01405644,  47.66207509,  34.40511192,
         12.62191209, -12.22069342, -33.97384411, -47.3636218 ,
        -49.29633006, -39.57750286, -20.86324707,   2.14016857,
         24.02439425,  40.24390575,  48.53552961,  49.85789854,
         48.27916691,  48.27916691,  49.85789854,  48.53552961,
         40.24390575,  24.02439425,   2.14016857, -20.86324707,
        -39.57750286, -49.29633006, -47.3636218 , -33.97384411,
        -12.22069342,  12.62191209,  34.40511192,  47.66207509,
         49.01405644,  38.05867484,  17.5046284 ,  -7.48984656,
        -30.61197197, -45.99528057, -49.71746546, -40.81010561,
        -21.51831106,   3.26034351],
       [  6.3617409 , -18.54423721, -38.76008802, -49.21686027,
        -47.3230047 , -33.59819679, -11.51748444,  13.38665832,
         34.92886962,  47.8206604 ,  48.97182072,  38.21862758,
         18.30496288,  -5.86406493, -28.49062723, -44.33911505,
        -49.99984285, -44.63989072, -30.0576376 , -10.04083694,
         10.79132365,  28.34765882,  40.24390575,  46.39010774,
         48.53552961,  48.53552961,  46.39010774,  40.24390575,
         28.34765882,  10.79132365, -10.04083694, -30.0576376 ,
        -44.63989072, -49.99984285, -44.33911505, -28.49062723,
         -5.86406493,  18.30496288,  38.21862758,  48.97182072,
         47.8206604 ,  34.92886962,  13.38665832, -11.51748444,
        -33.59819679, -47.3230047 , -49.21686027, -38.76008802,
        -18.54423721,   6.3617409 ],
       [ 10.43331167, -14.48500294, -35.77286234, -48.17499183,
        -48.67753066, -37.22859075, -16.71188321,   7.80751286,
         30.3632855 ,  45.56343465,  49.88842203,  42.49237499,
         25.32127949,   2.54010926, -20.56322029, -38.90060036,
        -48.78775742, -48.72592859, -39.57750286, -24.11768466,
         -6.11297976,  10.79132365,  24.02439425,  32.53979606,
         36.5327181 ,  36.5327181 ,  32.53979606,  24.02439425,
         10.79132365,  -6.11297976, -24.11768466, -39.57750286,
        -48.72592859, -48.78775742, -38.90060036, -20.56322029,
          2.54010926,  25.32127949,  42.49237499,  49.88842203,
         45.56343465,  30.3632855 ,   7.80751286, -16.71188321,
        -37.22859075, -48.67753066, -48.17499183, -35.77286234,
        -14.48500294,  10.43331167],
       [ 15.38398164,  -9.30515297, -31.67378034, -46.29910521,
        -49.70326036, -41.16643766, -22.84813325,   0.79661449,
         24.14323823,  41.77262971,  49.74867586,  46.48768883,
         33.02229327,  12.62191209, -10.10434008, -30.37107193,
        -44.33911505, -49.91598595, -47.05222652, -37.49579308,
        -24.11768466, -10.04083694,   2.14016857,  10.79132365,
         15.20233285,  15.20233285,  10.79132365,   2.14016857,
        -10.04083694, -24.11768466, -37.49579308, -47.05222652,
        -49.91598595, -44.33911505, -30.37107193, -10.10434008,
         12.62191209,  33.02229327,  46.48768883,  49.74867586,
         41.77262971,  24.14323823,   0.79661449, -22.84813325,
        -41.16643766, -49.70326036, -46.29910521, -31.67378034,
         -9.30515297,  15.38398164],
       [ 21.0585839 ,  -3.01485101, -26.30068998, -43.26604004,
        -49.96931035, -44.96246634, -29.56888668,  -7.48984656,
         16.14071378,  36.00235024,  47.8206604 ,  49.28902915,
         40.47349117,  23.6334479 ,   2.54010926, -18.50479761,
        -35.6853225 , -46.46786759, -49.99984285, -47.05222652,
        -39.57750286, -30.0576376 , -20.86324707, -13.81607136,
        -10.04083694, -10.04083694, -13.81607136, -20.86324707,
        -30.0576376 , -39.57750286, -47.05222652, -49.99984285,
        -46.46786759, -35.6853225 , -18.50479761,   2.54010926,
         23.6334479 ,  40.47349117,  49.28902915,  47.8206604 ,
         36.00235024,  16.14071378,  -7.48984656, -29.56888668,
        -44.96246634, -49.96931035, -43.26604004, -26.30068998,
         -3.01485101,  21.0585839 ],
       [ 27.21773934,   4.29784512, -19.54313453, -38.76008802,
        -48.99592583, -48.0597388 , -36.35991327, -16.71188321,
          6.40482147,  27.93583221,  43.40992382,  49.88726895,
         46.48768883,  34.40511192,  16.44707577,  -3.74796758,
        -22.59585866, -37.32946284, -46.46786759, -49.91598595,
        -48.72592859, -44.63989072, -39.57750286, -35.21505282,
        -32.73533634, -32.73533634, -35.21505282, -39.57750286,
        -44.63989072, -48.72592859, -49.91598595, -46.46786759,
        -37.32946284, -22.59585866,  -3.74796758,  16.44707577,
         34.40511192,  46.48768883,  49.88726895,  43.40992382,
         27.93583221,   6.40482147, -16.71188321, -36.35991327,
        -48.0597388 , -48.99592583, -38.76008802, -19.54313453,
          4.29784512,  27.21773934],
       [ 33.52200674,  12.43444466, -11.38773928, -32.52344566,
        -46.29910521, -49.82006561, -42.54666743, -26.30403387,
         -4.75548615,  17.5046284 ,  36.00235024,  47.32556664,
         49.74682053,  43.41218073,  30.09542706,  12.62191209,
         -5.86406493, -22.59585866, -35.6853225 , -44.33911505,
        -48.78775742, -49.99984285, -49.29633006, -47.97938883,
        -47.05222652, -47.05222652, -47.97938883, -49.29633006,
        -49.99984285, -48.78775742, -44.33911505, -35.6853225 ,
        -22.59585866,  -5.86406493,  12.62191209,  30.09542706,
         43.41218073,  49.74682053,  47.32556664,  36.00235024,
         17.5046284 ,  -4.75548615, -26.30403387, -42.54666743,
        -49.82006561, -46.29910521, -32.52344566, -11.38773928,
         12.43444466,  33.52200674],
       [ 39.52529667,  21.0585839 ,  -1.96524628, -24.41694066,
        -41.45470915, -49.57790278, -47.3230047 , -35.4650208 ,
        -16.71188321,   5.00127125,  25.42588987,  40.89717524,
         49.01405644,  48.97182072,  41.51268165,  28.55383208,
         12.62191209,  -3.74796758, -18.50479761, -30.37107193,
        -38.90060036, -44.33911505, -47.3636218 , -48.78775742,
        -49.30414846, -49.30414846, -48.78775742, -47.3636218 ,
        -44.33911505, -38.90060036, -30.37107193, -18.50479761,
         -3.74796758,  12.62191209,  28.55383208,  41.51268165,
         48.97182072,  49.01405644,  40.89717524,  25.42588987,
          5.00127125, -16.71188321, -35.4650208 , -47.3230047 ,
        -49.57790278, -41.45470915, -24.41694066,  -1.96524628,
         21.0585839 ,  39.52529667],
       [ 44.68293574,  29.68052637,   8.40800154, -14.48500294,
        -34.1789875 , -46.72343969, -49.82006561, -43.1939961 ,
        -28.50282892,  -8.84317884,  11.99895686,  30.3632855 ,
         43.40992382,  49.55635532,  48.59515508,  41.51268165,
         30.09542706,  16.44707577,   2.54010926, -10.10434008,
        -20.56322029, -28.49062723, -33.97384411, -37.32946284,
        -38.90060036, -38.90060036, -37.32946284, -33.97384411,
        -28.49062723, -20.56322029, -10.10434008,   2.54010926,
         16.44707577,  30.09542706,  41.51268165,  48.59515508,
         49.55635532,  43.40992382,  30.3632855 ,  11.99895686,
         -8.84317884, -28.50282892, -43.1939961 , -49.82006561,
        -46.72343969, -34.1789875 , -14.48500294,   8.40800154,
         29.68052637,  44.68293574],
       [ 48.37926464,  37.66118052,  19.203632  ,  -3.01485101,
        -24.41694066, -40.81010561, -49.21686027, -48.38350015,
        -38.88582763, -22.84813325,  -3.37638528,  16.14071378,
         32.69779178,  44.16929479,  49.55635532,  48.97182072,
         43.41218073,  34.40511192,  23.6334479 ,  12.62191209,
          2.54010926,  -5.86406493, -12.22069342, -16.42524335,
        -18.50479761, -18.50479761, -16.42524335, -12.22069342,
         -5.86406493,   2.54010926,  12.62191209,  23.6334479 ,
         34.40511192,  43.41218073,  48.97182072,  49.55635532,
         44.16929479,  32.69779178,  16.14071378,  -3.37638528,
        -22.84813325, -38.88582763, -48.38350015, -49.21686027,
        -40.81010561, -24.41694066,  -3.01485101,  19.203632  ,
         37.66118052,  48.37926464],
       [ 49.97791099,  44.2426231 ,  29.68052637,   9.42347921,
        -12.42420023, -31.67378034, -44.88457096, -49.96931035,
        -46.46747149, -35.4650208 , -19.21860024,  -0.59931159,
         17.5046284 ,  32.69779178,  43.40992382,  49.01405644,
         49.74682053,  46.48768883,  40.47349117,  33.02229327,
         25.32127949,  18.30496288,  12.62191209,   8.66726834,
          6.64802231,   6.64802231,   8.66726834,  12.62191209,
         18.30496288,  25.32127949,  33.02229327,  40.47349117,
         46.48768883,  49.74682053,  49.01405644,  43.40992382,
         32.69779178,  17.5046284 ,  -0.59931159, -19.21860024,
        -35.4650208 , -46.46747149, -49.96931035, -44.88457096,
        -31.67378034, -12.42420023,   9.42347921,  29.68052637,
         44.2426231 ,  49.97791099],
       [ 48.89471703,  48.60971434,  38.91963015,  21.97115032,
          1.17639653, -19.54313453, -36.54545526, -47.12355534,
        -49.90768134, -44.96246634, -33.59819679, -17.97344647,
         -0.59931159,  16.14071378,  30.3632855 ,  40.89717524,
         47.32556664,  49.88726895,  49.28902915,  46.48768883,
         42.49237499,  38.21862758,  34.40511192,  31.58534101,
         30.09542706,  30.09542706,  31.58534101,  34.40511192,
         38.21862758,  42.49237499,  46.48768883,  49.28902915,
         49.88726895,  47.32556664,  40.89717524,  30.3632855 ,
         16.14071378,  -0.59931159, -17.97344647, -33.59819679,
        -44.96246634, -49.90768134, -47.12355534, -36.54545526,
        -19.54313453,   1.17639653,  21.97115032,  38.91963015,
         48.60971434,  48.89471703],
       [ 44.68883155,  49.98295952,  45.90063253,  33.52200674,
         15.38398164,  -5.11489064, -24.41694066, -39.46233846,
        -48.17499183, -49.70326036, -44.40206757, -33.59819679,
        -19.21860024,  -3.37638528,  11.99895686,  25.42588987,
         36.00235024,  43.40992382,  47.8206604 ,  49.74867586,
         49.88842203,  48.97182072,  47.66207509,  46.48768883,
         45.8096484 ,  45.8096484 ,  46.48768883,  47.66207509,
         48.97182072,  49.88842203,  49.74867586,  47.8206604 ,
         43.40992382,  36.00235024,  25.42588987,  11.99895686,
         -3.37638528, -19.21860024, -33.59819679, -44.40206757,
        -49.70326036, -48.17499183, -39.46233846, -24.41694066,
         -5.11489064,  15.38398164,  33.52200674,  45.90063253,
         49.98295952,  44.68883155],
       [ 37.16219398,  47.73654523,  49.62054713,  42.81971738,
         28.87224009,  10.43331167,  -9.30515297, -27.22644278,
        -40.81010561, -48.47468376, -49.70326036, -44.96246634,
        -35.4650208 , -22.84813325,  -8.84317884,   5.00127125,
         17.5046284 ,  27.93583221,  36.00235024,  41.77262971,
         45.56343465,  47.8206604 ,  49.01405644,  49.55635532,
         49.74867586,  49.74867586,  49.55635532,  49.01405644,
         47.8206604 ,  45.56343465,  41.77262971,  36.00235024,
         27.93583221,  17.5046284 ,   5.00127125,  -8.84317884,
        -22.84813325, -35.4650208 , -44.96246634, -49.70326036,
        -48.47468376, -40.81010561, -27.22644278,  -9.30515297,
         10.43331167,  28.87224009,  42.81971738,  49.62054713,
         47.73654523,  37.16219398],
       [ 26.45245473,  41.52825206,  49.24556663,  48.60971434,
         40.11503905,  25.51450425,   7.38728486, -11.38773928,
        -28.14077278, -40.81010561, -48.17499183, -49.90768134,
        -46.46747149, -38.88582763, -28.50282892, -16.71188321,
         -4.75548615,   6.40482147,  16.14071378,  24.14323823,
         30.3632855 ,  34.92886962,  38.05867484,  39.98551824,
         40.89717524,  40.89717524,  39.98551824,  38.05867484,
         34.92886962,  30.3632855 ,  24.14323823,  16.14071378,
          6.40482147,  -4.75548615, -16.71188321, -28.50282892,
        -38.88582763, -46.46747149, -49.90768134, -48.17499183,
        -40.81010561, -28.14077278, -11.38773928,   7.38728486,
         25.51450425,  40.11503905,  48.60971434,  49.24556663,
         41.52825206,  26.45245473],
       [ 13.100533  ,  31.42107575,  44.27783047,  49.83312362,
         47.58177837,  38.29820164,  23.76483689,   6.3617409 ,
        -11.38773928, -27.22644278, -39.46233846, -47.12355534,
        -49.96931035, -48.38350015, -43.1939961 , -35.4650208 ,
        -26.30403387, -16.71188321,  -7.48984656,   0.79661449,
          7.80751286,  13.38665832,  17.5046284 ,  20.20004232,
         21.52903306,  21.52903306,  20.20004232,  17.5046284 ,
         13.38665832,   7.80751286,   0.79661449,  -7.48984656,
        -16.71188321, -26.30403387, -35.4650208 , -43.1939961 ,
        -48.38350015, -49.96931035, -47.12355534, -39.46233846,
        -27.22644278, -11.38773928,   6.3617409 ,  23.76483689,
         38.29820164,  47.58177837,  49.83312362,  44.27783047,
         31.42107575,  13.100533  ],
       [ -1.92712343,  17.97162887,  34.70993361,  45.83707278,
         49.98295952,  46.96192173,  37.66118052,  23.76483689,
          7.38728486,  -9.30515297, -24.41694066, -36.54545526,
        -44.88457096, -49.21686027, -49.82006561, -47.3230047 ,
        -42.54666743, -36.35991327, -29.56888668, -22.84813325,
        -16.71188321, -11.51748444,  -7.48984656,  -4.75548615,
         -3.37638528,  -3.37638528,  -4.75548615,  -7.48984656,
        -11.51748444, -16.71188321, -22.84813325, -29.56888668,
        -36.35991327, -42.54666743, -47.3230047 , -49.82006561,
        -49.21686027, -44.88457096, -36.54545526, -24.41694066,
         -9.30515297,   7.38728486,  23.76483689,  37.66118052,
         46.96192173,  49.98295952,  45.83707278,  34.70993361,
         17.97162887,  -1.92712343],
       [-17.27876079,   2.25956202,  21.13453178,  36.56495468,
         46.53016369,  49.99858565,  46.96192173,  38.29820164,
         25.51450425,  10.43331167,  -5.11489064, -19.54313453,
        -31.67378034, -40.81010561, -46.72343969, -49.57790278,
        -49.82006561, -48.0597388 , -44.96246634, -41.16643766,
        -37.22859075, -33.59819679, -30.61197197, -28.50282892,
        -27.41435247, -27.41435247, -28.50282892, -30.61197197,
        -33.59819679, -37.22859075, -41.16643766, -44.96246634,
        -48.0597388 , -49.82006561, -49.57790278, -46.72343969,
        -40.81010561, -31.67378034, -19.54313453,  -5.11489064,
         10.43331167,  25.51450425,  38.29820164,  46.96192173,
         49.99858565,  46.53016369,  36.56495468,  21.13453178,
          2.25956202, -17.27876079],
       [-31.32994897, -14.16323739,   4.77658056,  22.6846354 ,
         37.16219398,  46.53016369,  49.98295952,  47.58177837,
         40.11503905,  28.87224009,  15.38398164,   1.17639653,
        -12.42420023, -24.41694066, -34.1789875 , -41.45470915,
        -46.29910521, -48.99592583, -49.96931035, -49.70326036,
        -48.67753066, -47.3230047 , -45.99528057, -44.96246634,
        -44.40206757, -44.40206757, -44.96246634, -45.99528057,
        -47.3230047 , -48.67753066, -49.70326036, -49.96931035,
        -48.99592583, -46.29910521, -41.45470915, -34.1789875 ,
        -24.41694066, -12.42420023,   1.17639653,  15.38398164,
         28.87224009,  40.11503905,  47.58177837,  49.98295952,
         46.53016369,  37.16219398,  22.6846354 ,   4.77658056,
        -14.16323739, -31.32994897],
       [-42.36704525, -29.41449899, -12.57683887,   5.61500264,
         22.6846354 ,  36.56495468,  45.83707278,  49.83312362,
         48.60971434,  42.81971738,  33.52200674,  21.97115032,
          9.42347921,  -3.01485101, -14.48500294, -24.41694066,
        -32.52344566, -38.76008802, -43.26604004, -46.29910521,
        -48.17499183, -49.21686027, -49.71746546, -49.9134038 ,
        -49.96931035, -49.96931035, -49.9134038 , -49.71746546,
        -49.21686027, -48.17499183, -46.29910521, -43.26604004,
        -38.76008802, -32.52344566, -24.41694066, -14.48500294,
         -3.01485101,   9.42347921,  21.97115032,  33.52200674,
         42.81971738,  48.60971434,  49.83312362,  45.83707278,
         36.56495468,  22.6846354 ,   5.61500264, -12.57683887,
        -29.41449899, -42.36704525],
       [-48.82555555, -41.50974692, -28.75928737, -12.57683887,
          4.77658056,  21.13453178,  34.70993361,  44.27783047,
         49.24556663,  49.62054713,  45.90063253,  38.91963015,
         29.68052637,  19.203632  ,   8.40800154,  -1.96524628,
        -11.38773928, -19.54313453, -26.30068998, -31.67378034,
        -35.77286234, -38.76008802, -40.81010561, -42.07919314,
        -42.6831154 , -42.6831154 , -42.07919314, -40.81010561,
        -38.76008802, -35.77286234, -31.67378034, -26.30068998,
        -19.54313453, -11.38773928,  -1.96524628,   8.40800154,
         19.203632  ,  29.68052637,  38.91963015,  45.90063253,
         49.62054713,  49.24556663,  44.27783047,  34.70993361,
         21.13453178,   4.77658056, -12.57683887, -28.75928737,
        -41.50974692, -48.82555555],
       [-49.55267006, -48.65355867, -41.50974692, -29.41449899,
        -14.16323739,   2.25956202,  17.97162887,  31.42107575,
         41.52825206,  47.73654523,  49.98295952,  48.60971434,
         44.2426231 ,  37.66118052,  29.68052637,  21.0585839 ,
         12.43444466,   4.29784512,  -3.01485101,  -9.30515297,
        -14.48500294, -18.54423721, -21.51831106, -23.45995778,
        -24.41694066, -24.41694066, -23.45995778, -21.51831106,
        -18.54423721, -14.48500294,  -9.30515297,  -3.01485101,
          4.29784512,  12.43444466,  21.0585839 ,  29.68052637,
         37.66118052,  44.2426231 ,  48.60971434,  49.98295952,
         47.73654523,  41.52825206,  31.42107575,  17.97162887,
          2.25956202, -14.16323739, -29.41449899, -41.50974692,
        -48.65355867, -49.55267006],
       [-44.05124104, -49.55267006, -48.82555555, -42.36704525,
        -31.32994897, -17.27876079,  -1.92712343,  13.100533  ,
         26.45245473,  37.16219398,  44.68883155,  48.89471703,
         49.97791099,  48.37926464,  44.68293574,  39.52529667,
         33.52200674,  27.21773934,  21.0585839 ,  15.38398164,
         10.43331167,   6.3617409 ,   3.26034351,   1.17639653,
          0.1308314 ,   0.1308314 ,   1.17639653,   3.26034351,
          6.3617409 ,  10.43331167,  15.38398164,  21.0585839 ,
         27.21773934,  33.52200674,  39.52529667,  44.68293574,
         48.37926464,  49.97791099,  48.89471703,  44.68883155,
         37.16219398,  26.45245473,  13.100533  ,  -1.92712343,
        -17.27876079, -31.32994897, -42.36704525, -48.82555555,
        -49.55267006, -44.05124104]]
    },
    {
      name: 'Dataset 2',
      data: data_3dplot
    },
    {
      name: 'Dataset 3',
      data: dataFromFormular(function(x,y){
          return -(Math.cos(Math.sqrt(x*x+y*y)/6*Math.PI)+1)*300/(Math.pow(x*x+y*y+1,0.3)+1)+50;
        })
    }
  ];
  var selected=surfaces[0];

  var ul=d3.select('#feature-3d').append('ul');
  var svg=d3.select("#feature-3d").append('svg').attr('height',height).attr('width',width);

  var group = svg.append("g");

  var md=group.data([surfaces[0].data])
    .surface3D(width,height)
      .surfaceHeight(function(d){
        return d;
      }).surfaceColor(function(d){
        var c=d3.hsl((d+100), 0.6, 0.5).rgb();
        return "rgb("+parseInt(c.r)+","+parseInt(c.g)+","+parseInt(c.b)+")";
      });

  ul.selectAll('li')
    .data(surfaces)
      .enter().append('li')
        .html(function(d){
          return d.name
        }).on('mousedown',function(){
          md.data([d3.select(this).datum().data]).surface3D()
            .transition().duration(500)
            .surfaceHeight(function(d){
              return d;
            }).surfaceColor(function(d){
              var c=d3.hsl((d+100), 0.6, 0.5).rgb();
              return "rgb("+parseInt(c.r)+","+parseInt(c.g)+","+parseInt(c.b)+")";
            });
        });

  svg.on("mousedown",function(){
    drag=[d3.mouse(this),yaw,pitch];
  }).on("mouseup",function(){
    drag=false;
  }).on("mousemove",function(){
    if(drag){
      var mouse=d3.mouse(this);
      yaw=drag[1]-(mouse[0]-drag[0][0])/50;
      pitch=drag[2]+(mouse[1]-drag[0][1])/50;
      pitch=Math.max(-Math.PI/2,Math.min(Math.PI/2,pitch));
      md.turntable(yaw,pitch);
    }
  });

})